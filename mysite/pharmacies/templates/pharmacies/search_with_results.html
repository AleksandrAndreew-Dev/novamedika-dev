{% extends 'base.html' %}
{% load static %}
{% load customfilters %}

{% block title %}
Поиск лекарств
{% endblock %}

{% block results %}

<div class="results container-lg">
    {% if page_obj %}
    <h5 class="results-text">Результаты поиска:  </h5>
    <span class='results-text2'>{{ query }} {{ form_query }} -  {{ first_product.manufacturer }} {{ first_product.country }}</span>


    <table id="results-table" class="table-sm table-light-active align-middle">
        <thead>
        <tr class="table-light">
            <th scope="col">Аптека</th>
            <th scope="col">Город</th>
            <th scope="col">Адрес</th>
            <th scope="col">Телефон</th>
            <th scope="col">Название</th>
             <th scope="col">Форма</th>
             <th scope="col">Цена в аптеке бел.руб</th>


            
            <th scope="col">Количество в Аптеке</th>
            <th scope="col">Производитель, Страна</th>



        </tr>
        </thead>
    <tbody>
    {% for group in page_obj %}
    <tr class="table-light">
        <td class="table-light">{{ group.pharmacy_name }} №{{ group.pharmacy_number }}</td>
        <td class="table-light">{{ group.pharmacy_city }}</td>
        <td class="table-light">{{ group.pharmacy_address }}</td>
        <td class="table-light">{{ group.pharmacy_phone }}</td>
        <td class="table-light">{{ group.name }}</td>
        <td class="table-light">{{ group.form }}</td>
        <td class="table-light"><span class="pharma-price">{{ group.price }} Br</span></td>

        <td class="table-light">{{ group.quantity }} уп. <br> Уточняйте кол-во в аптеке</td> <!-- Total quantity -->
        <td class="table-light">{{ group.manufacturer }}, {{ group.country }}</td>

    </tr>
    {% empty %}
    <tr>
        <td colspan="12" class="text-center">Ничего не найдено</td>
    </tr>
    {% endfor %}
</tbody>

    </table>

</div>



{% endif %}

{% block script %}

<script>
    if (!$.fn.dataTable.isDataTable('#results-table')) {
      var table = $('#results-table').DataTable({
          paging: true,
          searching: false,
          ordering: true,
          order: [[6, 'desc']],
          pageLength: 10,

          language: {
              url: '/static/js/table_ru.json'
          }

      });

      // Отсрочка изменения текста после завершения инициализации
      table.on('init', function() {
          $('.dataTables_filter label').contents().first()[0].textContent = 'Поиск по результатам: ';
      });
  }



</script>

{% endblock %}
{% endblock %}
